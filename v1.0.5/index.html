<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>SimSpin.jl Documentation · SimSpin.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href><img src="assets/logo.png" alt="SimSpin.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">SimSpin.jl</span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>SimSpin.jl Documentation</a><ul class="internal"><li><a class="tocitem" href="#Usage"><span>Usage</span></a></li><li><a class="tocitem" href="#General-Functions"><span>General Functions</span></a></li><li><a class="tocitem" href="#Constructors"><span>Constructors</span></a></li><li><a class="tocitem" href="#Multi-Threading"><span>Multi-Threading</span></a></li><li><a class="tocitem" href="#Data-Import"><span>Data Import</span></a></li><li><a class="tocitem" href="#Data-Export"><span>Data Export</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>SimSpin.jl Documentation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>SimSpin.jl Documentation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/kateharborne/SimSpin.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="SimSpin.jl-Documentation"><a class="docs-heading-anchor" href="#SimSpin.jl-Documentation">SimSpin.jl Documentation</a><a id="SimSpin.jl-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#SimSpin.jl-Documentation" title="Permalink"></a></h1><h2 id="Usage"><a class="docs-heading-anchor" href="#Usage">Usage</a><a id="Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Usage" title="Permalink"></a></h2><p>For the installation procedure of the SimSpin package please follow the installation instructions on the package&#39;s <a href="https://github.com/kateharborne/SimSpin.jl"><em>README</em></a>.</p><h3 id="Mock-observables-of-an-N-body-simulation"><a class="docs-heading-anchor" href="#Mock-observables-of-an-N-body-simulation">Mock observables of an N-body simulation</a><a id="Mock-observables-of-an-N-body-simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Mock-observables-of-an-N-body-simulation" title="Permalink"></a></h3><p>Once installed, only five steps are required to take an observation, generate a mock-IFU datacube and then export it to a FITS file:</p><ol><li><p>Construct a <code>Telescope</code> object. This specifies the field of view to be used, the aperture shape, etc. In this example we will use the default <a href="#SimSpin.SAMI"><code>SAMI</code></a> telescope constructor. See <a href="#Telescope-Constructors">Telescope Constructors</a> for other default and customisable constructors.</p><p><code>&gt; telescope = SAMI()</code></p></li><li><p>Construct an environment in which the observation is taken. This specifies the redshift of the galaxy, its inclination, the virial radius, the mass to light ratio and the seeing conditions respectively. We will set redshift to be 0.05, inclination to be 70 degrees, virial radius to be 200 kpc, to mass to light ratio to be 1 and use no blurring. See <a href="#Environment-Constructor">Environment Constructor</a> and <a href="#Blur-Constructors">Blur Constructors</a> for more details.</p><p><code>&gt; environment = Environment(0.05, 70, 200, 1.)</code></p></li><li><p>Read in a simulation&#39;s particle data. In this example we will use the example file embedded in SimSpin. Usually you will need to pass <a href="#SimSpin.sim_data"><code>sim_data</code></a> the file path to your HDF5 data file. See <a href="#Data-Import">Data Import</a> for more details.</p><p><code>&gt; data = sim_data()</code></p></li><li><p>Build the datacube as a combination of the galaxy particle data, a telescope and an environment. It returns a mock-IFU datacube and a summary of the observational properties used. See <a href="#SimSpin.build_datacube"><code>build_datacube</code></a> for more details.</p><p><code>&gt; datacube, observe = build_datacube(data, telescope, environment)</code></p></li><li><p>Export the datacube to a FITS file for viewing. See <a href="#Data-Export">Data Export</a> for more details</p><p><code>&gt; sim_FITS(datacube, observe, &quot;SimSpin_Example_Observation.fits&quot;)</code></p></li></ol><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The most efficient way to take multiple observations is to pass <a href="#SimSpin.build_datacube"><code>build_datacube</code></a> an array of Environments. These can be created individually or by passing the <a href="#Environment-Constructor">Environment Constructor</a> an array of the values that you wish to observe. For example, to take an observation at redshifts 0.05, 0.1 and 0.15 each at an inclination of 70 degrees and 80 degrees using a constant virial radius of 200 kpc there are two options:</p><pre><code class="language-none">    &gt; environments = Environment([0.05; 0.1; 015], [70; 80], 200)
    &gt; environments = Environment(0.05:0.05:0.15, 70:10:80, 200)</code></pre><p>Both options will return an array of environments which can then be used as the environment parameter in Step 4 above. This will then return an array of tuples, each one consisting of the datacube and the observational properties used. See <a href="#SimSpin.build_datacube"><code>build_datacube</code></a> and <a href="#Environment-Constructor">Environment Constructor</a> for more details.</p></div></div><h3 id="Mock-observables-of-a-hydro-dynamical-simulation"><a class="docs-heading-anchor" href="#Mock-observables-of-a-hydro-dynamical-simulation">Mock observables of a hydro-dynamical simulation</a><a id="Mock-observables-of-a-hydro-dynamical-simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Mock-observables-of-a-hydro-dynamical-simulation" title="Permalink"></a></h3><p>To use SimSpin with a hydro-dynamical simulation a similar process is followed with notable, minor differences:</p><ol><li><p>Construct a <code>Telescope</code> object. We must specify a filter when using a hydro-dynamical simulation. See <a href="#Telescope-Constructors">Telescope Constructors</a> for more options.</p><p><code>&gt; telescope = SAMI(filter=&quot;g&quot;)</code></p></li><li><p>Construct an environment in which the observation is taken. This is the same as for an n-body simulation but does not require a mass to light ratio. See <a href="#Environment-Constructor">Environment Constructor</a> and <a href="#Blur-Constructors">Blur Constructors</a> for more details.</p><p><code>&gt; environment = Environment(0.05, 70, 200)</code></p></li><li><p>Read in a simulation&#39;s particle data. For hydro-dynamical simulations we must specify that we want SSP to be used. The default is to not use SSP data so if SSP is not actively set to true a hydro-dynamical simulation will still be observed but a mass to light ratio will be used instead of spectra. See <a href="#Data-Import">Data Import</a> for more details.</p><p><code>&gt; data = sim_data(&quot;your/filename.hdf5&quot;, ssp=true)</code></p></li><li><p>Build the datacube as a combination of the galaxy particle data, a telescope and an environment. It returns a mock-IFU datacube and a summary of the observational properties used. See <a href="#SimSpin.build_datacube"><code>build_datacube</code></a> for more details.</p><p><code>&gt; datacube, observe = build_datacube(data, telescope, environment)</code></p></li><li><p>Export the datacube to a FITS file for viewing. See <a href="#Data-Export">Data Export</a> for more details</p><p><code>&gt; sim_FITS(datacube, observe, &quot;SimSpin_Example_Observation.fits&quot;)</code></p></li></ol><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Do not multithread any SimSpin functions as a user. Each observation is already multithreaded and will run on as many threads as available. To see how to allow SimSpin to use more threads see <a href="#Multi-Threading">Multi-Threading</a>.</p></div></div><h2 id="General-Functions"><a class="docs-heading-anchor" href="#General-Functions">General Functions</a><a id="General-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#General-Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="SimSpin.build_datacube" href="#SimSpin.build_datacube"><code>SimSpin.build_datacube</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">build_datacube(galaxy_data, ifu, envir)</code></pre><p>Returns a simulated ifu datacube for input, <code>galaxy_data</code>, an array of <code>Particle</code> and a summary of observation properties used. The instrument to be used for observation is given in the <code>Telescope</code> class parameter and the environmental variables (redshift, inclination, seeing, etc) are given by the <code>Environment</code> class parameter.</p><p>Parameters:</p><pre><code class="language-none">galaxy_data         Array of `Particle` describing galaxy.
ifu                 Struct of type `Telescope`.
envir               Struct of type `Environment`.</code></pre><p>Returns:</p><pre><code class="language-none">datacube           3D array of a simulated IFU datacube with spatial and velocity binned fluxes.
observe             A struct of type `Observation` summarising the observational properties used.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kateharborne/SimSpin.jl/blob/6612f35d3006d66cb57af247c62da27564539f53/src/functions/build_datacube.jl#L5-L22">source</a></section><section><div><pre><code class="language-none">build_datacube(galaxy_data, ifu, environment_array)</code></pre><p>Calls <a href="#SimSpin.build_datacube"><code>build_datacube</code></a> using each environment in the array of Environment types. This is the most efficient way to take multiple observations.</p><p>Parameters:</p><pre><code class="language-none">galaxy_data         Array of `Particle` describing galaxy.
ifu                 Struct of type `Telescope`.
envir               Array of `Environment` describing each observation to be taken.</code></pre><p>Returns:</p><pre><code class="language-none">datacubes   An array of tuples. Each tuple constists of a datacube [1] and an `Observation` [2].</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kateharborne/SimSpin.jl/blob/6612f35d3006d66cb57af247c62da27564539f53/src/functions/build_datacube.jl#L46-L61">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SimSpin.flux_grid" href="#SimSpin.flux_grid"><code>SimSpin.flux_grid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">flux_grid(parts_in_cell,
            observe,
            filter)</code></pre><p>Computes the fluxes for each element of the IFU data-cube.</p><p>The purpose of this function is to construct the mock flux values within each cell of the IFU cube. It accepts output parameters from <code>obs_data_prep()</code> and returns a 3D array containing the flux at each cell position due to contributions from the particles. If ssd particles are supplied, an SED is generated in each cell using ProSpect. Else, the luminosity in each cell is converted to flux.</p><p>Parameters:</p><pre><code class="language-none">parts_in_cell       1D array of the particles corresponding to each element in the IFU data-cube.
observe             Struct of type `Observation` containing all observation parameters.
filter_value        If ssp particles are supplied, the filter within which the SED is generated.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kateharborne/SimSpin.jl/blob/6612f35d3006d66cb57af247c62da27564539f53/src/functions/flux_grid.jl#L5-L22">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SimSpin.ifu_cube" href="#SimSpin.ifu_cube"><code>SimSpin.ifu_cube</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">ifu_cube(flux_grid,
            parts_in_cell,
            observe)</code></pre><p>The purpose of this function is to construct an IFU data cube. It accepts a flux grid in the format output by the <code>flux_grid()</code> function and returns a similar, IFU-like, 3D array where each particle&#39;s flux contributes a Gaussian distribution in the velocity axis.</p><p>Parameters:</p><pre><code class="language-none">flux_grid       Flux grid output by `flux_grid()`
parts_in_cell   1D array of the particles corresponding to each element in the IFU data-cube.
observe         Struct of type `Observation` containing all observation parameters.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kateharborne/SimSpin.jl/blob/6612f35d3006d66cb57af247c62da27564539f53/src/functions/ifu_cube.jl#L7-L21">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SimSpin.obs_data_prep" href="#SimSpin.obs_data_prep"><code>SimSpin.obs_data_prep</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">obs_data_prep(galaxy_data, ifu, envir)</code></pre><p>This function prepares the particle data for a given observation with the given telescope.</p><p>Parameters:</p><pre><code class="language-none">galaxy_data         Array of `Particle` describing galaxy
ifu                 Struct of type `Telescope`
envir               Struct of type `Environment`</code></pre><p>Returns:</p><pre><code class="language-none">galaxy_data         Array of particle data formatted for the observation specified by the parameters.
parts_in_cell       3D array of the particles corresponding to each element in the IFU data-cube.
observe             Struct of type `Observation` containing all observation parameters.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kateharborne/SimSpin.jl/blob/6612f35d3006d66cb57af247c62da27564539f53/src/functions/obs_data_prep.jl#L5-L21">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SimSpin.sim_to_galaxy" href="#SimSpin.sim_to_galaxy"><code>SimSpin.sim_to_galaxy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">sim_to_galaxy(sim_data; centre)</code></pre><p>Returns particle data wrt centre of galaxy in both spatial and velocity space instead of wrt arbitrary point in simulation. Centre in position or centre in both position and velocity can be optionally specified. Else, the median of each distribution will be used as centre.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kateharborne/SimSpin.jl/blob/6612f35d3006d66cb57af247c62da27564539f53/src/utilities/sim_to_galaxy.jl#L5-L10">source</a></section></article><h2 id="Constructors"><a class="docs-heading-anchor" href="#Constructors">Constructors</a><a id="Constructors-1"></a><a class="docs-heading-anchor-permalink" href="#Constructors" title="Permalink"></a></h2><h3 id="Telescope-Constructors"><a class="docs-heading-anchor" href="#Telescope-Constructors">Telescope Constructors</a><a id="Telescope-Constructors-1"></a><a class="docs-heading-anchor-permalink" href="#Telescope-Constructors" title="Permalink"></a></h3><p>An <code>IFU</code> object denotes all the parameters required to make a mock observation. Any generic IFU can be made using the <code>IFU()</code> function. Default constructors can also be used to emulate famous IFU survey instruments. Currently <code>SAMI</code>, <code>MaNGA</code>, <code>CALIFA</code> and <code>Hector</code> are supported.</p><article class="docstring"><header><a class="docstring-binding" id="SimSpin.IFU" href="#SimSpin.IFU"><code>SimSpin.IFU</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">IFU(fov, ap_shape, central_wvl, lsf_fwhm, pixel_sscale, pixel_vscale,  filter)</code></pre><p>Creates a customisable, mock IFU telescope which can be used to &quot;observe&quot; simulations.</p><p>Parameters:</p><pre><code class="language-none">fov             The field of view of the IFU, diameter in arcseconds.
ap_shape        The shape of the field of view, with options &quot;circular&quot;, &quot;square&quot; or &quot;hexagonal&quot;.
central_wvl     The central filter wavelength used for the observation, given in angstroms.
lsf_fwhm        The line spread function full-width half-max, given in angstroms.
pixel_sscale    The corresponding spatial pixel scale associated with a given telescope output in arcseconds.
pixel_vscale    The corresponding velocity pixel scale associated with a given telescope filter output in angstroms.
filter          Optional. If particles type is ssp, the filter within which the SED is generated. Options include &quot;r&quot; and &quot;g&quot;  for SDSS-r and SDSS-g bands respectively.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kateharborne/SimSpin.jl/blob/6612f35d3006d66cb57af247c62da27564539f53/src/types/telescope_types.jl#L9-L23">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SimSpin.SAMI" href="#SimSpin.SAMI"><code>SimSpin.SAMI</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">SAMI(;filter)</code></pre><p>Creates an IFU using parameters of the SAMI survey. Optional filters &quot;r&quot; or &quot;g&quot; can also be specified for use with SSP particles.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kateharborne/SimSpin.jl/blob/6612f35d3006d66cb57af247c62da27564539f53/src/types/telescope_types.jl#L82-L87">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SimSpin.MaNGA" href="#SimSpin.MaNGA"><code>SimSpin.MaNGA</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">MaNGA(;filter)</code></pre><p>Creates an IFU using parameters of the MaNGA survey. Optional filters &quot;r&quot; or &quot;g&quot; can also be specified for use with SSP particles.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kateharborne/SimSpin.jl/blob/6612f35d3006d66cb57af247c62da27564539f53/src/types/telescope_types.jl#L98-L103">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SimSpin.CALIFA" href="#SimSpin.CALIFA"><code>SimSpin.CALIFA</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">CALIFA(;filter)</code></pre><p>Creates an IFU using parameters of the CALIFA survey. Optional filters &quot;r&quot; or &quot;g&quot; can also be specified for use with SSP particles.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kateharborne/SimSpin.jl/blob/6612f35d3006d66cb57af247c62da27564539f53/src/types/telescope_types.jl#L130-L135">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SimSpin.Hector" href="#SimSpin.Hector"><code>SimSpin.Hector</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">Hector(;filter)</code></pre><p>Creates an IFU using parameters of the CALIFA survey. Optional filters &quot;r&quot; or &quot;g&quot; can also be specified for use with SSP particles.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kateharborne/SimSpin.jl/blob/6612f35d3006d66cb57af247c62da27564539f53/src/types/telescope_types.jl#L146-L151">source</a></section></article><h3 id="Environment-Constructor"><a class="docs-heading-anchor" href="#Environment-Constructor">Environment Constructor</a><a id="Environment-Constructor-1"></a><a class="docs-heading-anchor-permalink" href="#Environment-Constructor" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="SimSpin.Environment" href="#SimSpin.Environment"><code>SimSpin.Environment</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Environment(z, inc_deg, r200, mass2light, blur)</code></pre><p>Creates a <code>struct</code> containing environmental parameters required for a mock observation of a simulated galaxy. Each argument can either be an array or a single value. If an array is passed then a corresponding array of Environments will be returned containing every permutation of the given parameters.</p><p>Parameters:</p><pre><code class="language-none">z               The projected redshift at which the observation is made.
inc_deg         The inclination at which to observe the galaxy in degrees. Relative to face on, rotated around semi-major axis.
r200            The virial radius specified in the simulation, kpc.
mass2light      Optional. The mass to light ratio for non-ssp, luminous particles. Can be omitted, a single value or a tuple to specifiy disk and bulge values separately.
blur            Optional. Struct of type `Blur` containing seeing information. If ommitted no blurring is used.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kateharborne/SimSpin.jl/blob/6612f35d3006d66cb57af247c62da27564539f53/src/types/environment_type.jl#L5-L18">source</a></section></article><h3 id="Blur-Constructors"><a class="docs-heading-anchor" href="#Blur-Constructors">Blur Constructors</a><a id="Blur-Constructors-1"></a><a class="docs-heading-anchor-permalink" href="#Blur-Constructors" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="SimSpin.Gaussian_blur" href="#SimSpin.Gaussian_blur"><code>SimSpin.Gaussian_blur</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Gaussian_blur(;sigma, fwhm)</code></pre><p>Create a struct containing seeing information.</p><p>Keyword arguments (only one may be specified):</p><pre><code class="language-none">sigma       The standard deviation of the point spread function
fwhm        The full width half max of the point spread function</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kateharborne/SimSpin.jl/blob/6612f35d3006d66cb57af247c62da27564539f53/src/types/blur_types.jl#L11-L20">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SimSpin.Moffat_blur" href="#SimSpin.Moffat_blur"><code>SimSpin.Moffat_blur</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Moffat_blur(β;
            α,
            fwhm)</code></pre><p>Create a struct containing seeing information. β and either α or fwhm must be specified. If both α and fwhm are specified, α is prioritised.</p><p>Arguments:</p><pre><code class="language-none">β           The power component in the Moffat distribution
α           The core width of the Moffat distribution (optional)
fwhm        The full width half max of the Moffat distribution (optional)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kateharborne/SimSpin.jl/blob/6612f35d3006d66cb57af247c62da27564539f53/src/types/blur_types.jl#L43-L56">source</a></section></article><h2 id="Multi-Threading"><a class="docs-heading-anchor" href="#Multi-Threading">Multi-Threading</a><a id="Multi-Threading-1"></a><a class="docs-heading-anchor-permalink" href="#Multi-Threading" title="Permalink"></a></h2><p>The SimSpin package has multi-threading enabled in some critical functions. To use SimSpin with more than one thread the only thing you need to do is start Julia with the desired number of threads. Instructions on how to do this can be found <a href="https://docs.julialang.org/en/v1/manual/multi-threading/#Starting-Julia-with-multiple-threads-1">here</a>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Do not manually multithread any SimSpin functions as a user. Each observation is already multithreaded and will run on as many threads as available.</p></div></div><h2 id="Data-Import"><a class="docs-heading-anchor" href="#Data-Import">Data Import</a><a id="Data-Import-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Import" title="Permalink"></a></h2><p>To read in a SimSpin HDF5 file as defined below the <a href="#SimSpin.sim_data"><code>sim_data</code></a> function must be used.</p><article class="docstring"><header><a class="docstring-binding" id="SimSpin.sim_data" href="#SimSpin.sim_data"><code>SimSpin.sim_data</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">sim_data(filename;
        pytpe = [],
        ssp = false)</code></pre><p>Reads in a <a href="https://github.com/kateharborne/create_SimSpinFile">SimSpin format</a> HDF5 file at location, <code>filename</code>. Returns array of Sim_particles.</p><p>Keyword arguments (optional):</p><pre><code class="language-none">ptype       A vector of the particles types to be read in e.g. ptype = [1,3].
            If omitted all particles types will be read.
ssp         Boolean value to use ssp particle information.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kateharborne/SimSpin.jl/blob/6612f35d3006d66cb57af247c62da27564539f53/src/io/sim_data.jl#L7-L20">source</a></section><section><div><pre><code class="language-none">sim_data(;ptype::Vector{} = [],
            ssp::Bool = false)</code></pre><p>if name filename is specified <code>sim_data</code> returns particle data from SimSpin&#39;s example file.</p><p>Keyword arguments (optional):</p><pre><code class="language-none">ptype       A vector of the particles types to be read in e.g. ptype = [1,3].
            If omitted all particles types will be read.
ssp         Boolean value to use ssp particle information.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kateharborne/SimSpin.jl/blob/6612f35d3006d66cb57af247c62da27564539f53/src/io/sim_data.jl#L125-L136">source</a></section></article><p>The expected file format accepted by SimSpin is outlined below.  If you would like to generate this file automatically, a short Python function has been written that uses the <a href="https://github.com/pynbody/pynbody">pynbody</a> package to read in various simulation data types and generate a SimSpin compatible HDF5 file. See <a href="https://github.com/kateharborne/create_SimSpinFile">create_SimSpinFile</a>.</p><p>If you would rather generate the SimSpin file independently, the expected file format is outlined below.</p><pre><code class="language-none">&gt; SimSpin_example.hdf5

&gt;&gt; /PartType0           # Each particle type included in the simulation has its own group.
&gt;&gt;&gt; /PartType0/Mass     # Each group then has a series of data sets assocaited,
&gt;&gt;&gt; /PartType0/vx       #   including the position, velocity and Mass of each particle.
&gt;&gt;&gt; /PartType0/vy
&gt;&gt;&gt; /PartType0/vz
&gt;&gt;&gt; /PartType0/x
&gt;&gt;&gt; /PartType0/y
&gt;&gt;&gt; /PartType0/z

&gt;&gt; /PartType1
&gt;&gt;&gt; ...</code></pre><p>We use the same PartType definition as Gadget: PartTypeX where 0 - gas, 1 - dark matter, 2 - disc, 3 - bulge, 4 - stars. For PartType0-3, each PartType group contains the same data sets as above. If the simulation contains stars, the Age and Metallicity information for each particle is also included:</p><pre><code class="language-none">&gt; SimSpin_example.hdf5
&gt;&gt; /PartType4
&gt;&gt;&gt; /PartType4/Age
&gt;&gt;&gt; /PartType4/Mass
&gt;&gt;&gt; /PartType4/Metallicity
&gt;&gt;&gt; /PartType4/vx        
&gt;&gt;&gt; /PartType4/vy
&gt;&gt;&gt; /PartType4/vz
&gt;&gt;&gt; /PartType4/x
&gt;&gt;&gt; /PartType4/y
&gt;&gt;&gt; /PartType4/z</code></pre><p>Optionally SSP Star particles can also be defined with initial mass and stellar formation time:</p><pre><code class="language-none">&gt; SimSpin_example.hdf5
&gt;&gt; /PartType4
&gt;&gt;&gt; /PartType4/InitialMass
&gt;&gt;&gt; /PartType4/Mass
&gt;&gt;&gt; /PartType4/Metallicity
&gt;&gt;&gt; /PartType4/StellarFormationTime
&gt;&gt;&gt; /PartType4/vx        
&gt;&gt;&gt; /PartType4/vy
&gt;&gt;&gt; /PartType4/vz
&gt;&gt;&gt; /PartType4/x
&gt;&gt;&gt; /PartType4/y
&gt;&gt;&gt; /PartType4/z</code></pre><p>If the file is set up in this way, the simulation data can easily be read into the SimSpin package.</p><h3 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h3><p>A. Pontzen, R Roskar, G. Stinson and R. Woods, (2013), &quot;pynbody: N-Body/SPH analysis for python&quot;,  Astrophysics Source Code Library, record ascl:1305.002</p><h2 id="Data-Export"><a class="docs-heading-anchor" href="#Data-Export">Data Export</a><a id="Data-Export-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Export" title="Permalink"></a></h2><p>Currently only FITS file exports are supported.</p><h3 id="FITS-Export"><a class="docs-heading-anchor" href="#FITS-Export">FITS Export</a><a id="FITS-Export-1"></a><a class="docs-heading-anchor-permalink" href="#FITS-Export" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="SimSpin.sim_FITS" href="#SimSpin.sim_FITS"><code>SimSpin.sim_FITS</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">sim_FITS(data_cube,
            observe,
            out_file)</code></pre><p>Outputs FITS file containing 3D, velocity binned datacube.</p><p>Parameters:</p><pre><code class="language-none">data_cube   3D array of a simulated IFU datacube with spatial and velocity binned fluxes
observe     A struct of type `Observation` summarising the observational properties used.
out_file    String denoting path and name of FITS file to be output.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kateharborne/SimSpin.jl/blob/6612f35d3006d66cb57af247c62da27564539f53/src/io/sim_FITS.jl#L7-L19">source</a></section><section><div><pre><code class="language-none">sim_FITS(data_cube,
            out_file)</code></pre><p>Outputs FITS file containing 3D, velocity binned datacube.</p><p>Parameters:</p><pre><code class="language-none">data_cube   Tuple with simulated IFU datacube and Observation as output from `build_datacube()`.
out_file    String denoting path and name of FITS file to be output.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kateharborne/SimSpin.jl/blob/6612f35d3006d66cb57af247c62da27564539f53/src/io/sim_FITS.jl#L53-L63">source</a></section><section><div><pre><code class="language-none">sim_FITS(out_data;
            folder = &quot;~&quot;,
            file_prefix = &quot;SimSpin&quot;)</code></pre><p>Can be used to export multiple datacubes in different FITS files.</p><p>Parameters:</p><pre><code class="language-none">out_data    Array of (datacube, observation) tuples. As output by `build_datacube()` when taking multiple observations.
folder      Optional. The file path to where the output should be. Defaults to &quot;~&quot;.
file_prefix Optional. Prefix for the start of the .fits file&#39;s name.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kateharborne/SimSpin.jl/blob/6612f35d3006d66cb57af247c62da27564539f53/src/io/sim_FITS.jl#L69-L81">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 22 July 2021 07:09">Thursday 22 July 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
